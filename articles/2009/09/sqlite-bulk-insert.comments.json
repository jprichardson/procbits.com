[
    {
        "date_created_gmt": "2012-03-19T21:46:30.000Z",
        "user_id": "0",
        "comment_id": "495",
        "parent": "0",
        "status": "approve",
        "content": "How to insert for columns with special characters, e.g., spaces,| ,% ,etc. I get an exception when executing the command, basically saying it can't find the column. I tried using brackets but that didn't help either. \r\n\r\nMany thanks if anyone can help.",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-495",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "Mike",
        "author_url": "",
        "author_email": "scanner37@gmail.com",
        "author_ip": "134.134.137.75",
        "type": ""
    },
    {
        "date_created_gmt": "2012-02-17T12:33:23.000Z",
        "user_id": "0",
        "comment_id": "444",
        "parent": "443",
        "status": "approve",
        "content": "Could be interresting yes. Which test library is the best iyo?",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-444",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "gpe",
        "author_url": "",
        "author_email": "guillaume.peugniez@mpro.de",
        "author_ip": "62.153.88.94",
        "type": ""
    },
    {
        "date_created_gmt": "2012-02-17T01:10:12.000Z",
        "user_id": "3046554",
        "comment_id": "443",
        "parent": "433",
        "status": "approve",
        "content": "Looks great! Any interest in packaging this up with tests and placing it on NuGet?",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-443",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "JP",
        "author_url": "http://gitpilot.com",
        "author_email": "jprichardson@gmail.com",
        "author_ip": "174.238.97.56",
        "type": ""
    },
    {
        "date_created_gmt": "2012-02-01T15:46:07.000Z",
        "user_id": "0",
        "comment_id": "433",
        "parent": "0",
        "status": "approve",
        "content": "Awesome results of course. Well done JP!\r\n\r\nI made it generic. Any suggestion? http://snipt.org/ylokj7",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-433",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "gpe",
        "author_url": "",
        "author_email": "guillaume.peugniez@mpro.de",
        "author_ip": "62.153.88.94",
        "type": ""
    },
    {
        "date_created_gmt": "2011-09-14T04:50:26.000Z",
        "user_id": "0",
        "comment_id": "304",
        "parent": "0",
        "status": "approve",
        "content": "Thank you very much!",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-304",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "Nguyen Dai Nghia",
        "author_url": "",
        "author_email": "nguyen.dainghia@gmail.com",
        "author_ip": "171.229.10.35",
        "type": ""
    },
    {
        "date_created_gmt": "2011-03-08T03:37:52.000Z",
        "user_id": "0",
        "comment_id": "115",
        "parent": "0",
        "status": "approve",
        "content": "Thank you very much for this excellent code... and to Jez for the small update.",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-115",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "Mervyn",
        "author_url": "",
        "author_email": "mervyng@yahoo.com",
        "author_ip": "41.132.223.41",
        "type": ""
    },
    {
        "date_created_gmt": "2010-11-03T02:14:29.000Z",
        "user_id": "0",
        "comment_id": "86",
        "parent": "0",
        "status": "approve",
        "content": "Jez, I had the same problem. Thanks for the code",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-86",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "campster",
        "author_url": "http://www.campster.fr",
        "author_email": "inf@campster.fr",
        "author_ip": "62.227.200.180",
        "type": ""
    },
    {
        "date_created_gmt": "2010-07-27T00:34:14.000Z",
        "user_id": "0",
        "comment_id": "46",
        "parent": "0",
        "status": "approve",
        "content": "strange, if I insert the code, it strips the generic notations, some invalid characters for comments probably... so the code above is incorrect...\r\n\r\nBasically the main (only?) change was in the dictionary declaration:\r\nprivate Dictionary&lt;string, SQLiteParameter&gt; m_parameters = new Dictionary&lt;string, SQLiteParameter&gt;();",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-46",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "Jez",
        "author_url": "http://www.automated-trading-system.com/",
        "author_email": "jez@automated-trading-system.com",
        "author_ip": "212.139.200.31",
        "type": ""
    },
    {
        "date_created_gmt": "2010-07-27T00:30:23.000Z",
        "user_id": "0",
        "comment_id": "45",
        "parent": "0",
        "status": "approve",
        "content": "Asanga, my description was not very precise - I had to replace Dictionary by Dictionary\r\n<code>\r\nprivate Dictionary m_parameters = new Dictionary();\r\n</code>\r\n\r\nThe full code for a utility class to do sqllite bulk imports:\r\n<code>\r\nusing System;\r\nusing System.Collections.Generic;\r\nusing System.Linq;\r\nusing System.Text;\r\nusing System.Data.SQLite;\r\nusing System.Data;\r\n\r\nnamespace DataTool\r\n{\r\n    public class SQLiteBulkInsert\r\n    {\r\n        private SQLiteConnection m_dbCon;\r\n        private SQLiteCommand m_cmd;\r\n        private SQLiteTransaction m_trans;\r\n\r\n        private Dictionary m_parameters = new Dictionary();\r\n\r\n        private uint m_counter = 0;\r\n\r\n        private string m_beginInsertText;\r\n\r\n        public SQLiteBulkInsert(SQLiteConnection dbConnection, string tableName)\r\n        {\r\n            m_dbCon = dbConnection;\r\n            m_tableName = tableName;\r\n\r\n            StringBuilder query = new StringBuilder(255);\r\n            query.Append(\"INSERT INTO [\"); query.Append(tableName); query.Append(\"] (\");\r\n            m_beginInsertText = query.ToString();\r\n        }\r\n\r\n        private bool m_allowBulkInsert = true;\r\n        public bool AllowBulkInsert { get { return m_allowBulkInsert; } set { m_allowBulkInsert = value; } }\r\n\r\n        public string CommandText\r\n        {\r\n            get\r\n            {\r\n                if (m_parameters.Count &lt; 1)\r\n                    throw new SQLiteException(&quot;You must add at least one parameter.&quot;);\r\n\r\n                StringBuilder sb = new StringBuilder(255);\r\n                sb.Append(m_beginInsertText);\r\n\r\n                foreach (string param in m_parameters.Keys)\r\n                {\r\n                    sb.Append(&#039;[&#039;);\r\n                    sb.Append(param);\r\n                    sb.Append(&#039;]&#039;);\r\n                    sb.Append(&quot;, &quot;);\r\n                }\r\n                sb.Remove(sb.Length - 2, 2);\r\n\r\n                sb.Append(&quot;) VALUES (&quot;);\r\n\r\n                foreach (string param in m_parameters.Keys)\r\n                {\r\n                    sb.Append(m_paramDelim);\r\n                    sb.Append(param);\r\n                    sb.Append(&quot;, &quot;);\r\n                }\r\n                sb.Remove(sb.Length - 2, 2);\r\n\r\n                sb.Append(&quot;)&quot;);\r\n\r\n                return sb.ToString();\r\n            }\r\n        }\r\n\r\n        private uint m_commitMax = 10000;\r\n        public uint CommitMax { get { return m_commitMax; } set { m_commitMax = value; } }\r\n\r\n        private string m_tableName;\r\n        public string TableName { get { return m_tableName; } }\r\n\r\n        private string m_paramDelim = &quot;:&quot;;\r\n        public string ParamDelimiter { get { return m_paramDelim; } }\r\n\r\n        public void AddParameter(string name, DbType dbType)\r\n        {\r\n            SQLiteParameter param = new SQLiteParameter(m_paramDelim + name, dbType);\r\n            m_parameters.Add(name, param);\r\n        }\r\n\r\n        public void Flush()\r\n        {\r\n            try\r\n            {\r\n                if (m_trans != null)\r\n                    m_trans.Commit();\r\n            }\r\n            catch (Exception ex) { throw new Exception(&quot;Could not commit transaction. See InnerException for more details&quot;, ex); }\r\n            finally\r\n            {\r\n                if (m_trans != null)\r\n                    m_trans.Dispose();\r\n\r\n                m_trans = null;\r\n                m_counter = 0;\r\n            }\r\n        }\r\n\r\n        public void Insert(object[] paramValues)\r\n        {\r\n            if (paramValues.Length != m_parameters.Count)\r\n                throw new Exception(&quot;The values array count must be equal to the count of the number of parameters.&quot;);\r\n\r\n            m_counter++;\r\n\r\n            if (m_counter == 1)\r\n            {\r\n                if (m_allowBulkInsert)\r\n                    m_trans = m_dbCon.BeginTransaction();\r\n\r\n                m_cmd = m_dbCon.CreateCommand();\r\n                foreach (SQLiteParameter par in m_parameters.Values)\r\n                    m_cmd.Parameters.Add(par);\r\n\r\n                m_cmd.CommandText = this.CommandText;\r\n            }\r\n\r\n            int i = 0;\r\n            foreach (SQLiteParameter par in m_parameters.Values)\r\n            {\r\n                par.Value = paramValues[i];\r\n                i++;\r\n            }\r\n\r\n            m_cmd.ExecuteNonQuery();\r\n\r\n            if (m_counter == m_commitMax)\r\n            {\r\n                try\r\n                {\r\n                    if (m_trans != null)\r\n                        m_trans.Commit();\r\n                }\r\n                catch (Exception) { }\r\n                finally\r\n                {\r\n                    if (m_trans != null)\r\n                    {\r\n                        m_trans.Dispose();\r\n                        m_trans = null;\r\n                    }\r\n\r\n                    m_counter = 0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n</code>",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-45",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "Jez",
        "author_url": "http://www.automated-trading-system.com/",
        "author_email": "jez@automated-trading-system.com",
        "author_ip": "212.139.200.31",
        "type": ""
    },
    {
        "date_created_gmt": "2010-07-26T17:37:34.000Z",
        "user_id": "0",
        "comment_id": "44",
        "parent": "42",
        "status": "approve",
        "content": "Hi Jez,\r\n\r\ncould you send me your changes (\"(ie replaced Dictionary with Dictionary for m_parameters\")...\r\nI have the same problems but seem to be unable to selve them ;(\r\n\r\nNeed the bulk insert cause I have way more then 20'' rows and in memory the operations are much faster then on the server - but it doesn't help me if I have to wait so long to import them...\r\nThanks a lot!",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-44",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "Asanga",
        "author_url": "",
        "author_email": "asanga.reinecke@gmail.com",
        "author_ip": "62.157.111.180",
        "type": ""
    },
    {
        "date_created_gmt": "2010-06-10T22:43:08.000Z",
        "user_id": "0",
        "comment_id": "42",
        "parent": "0",
        "status": "approve",
        "content": "Great stuff - what more could I wish for. A class that can be used in a generic manner - even with the test class... \r\n\r\nHad to make a few changes (ie replaced Dictionary with Dictionary for m_parameters as the compiler was complaining about it but apart from that it works - Thanks mate!",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-42",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "Jez",
        "author_url": "http://www.automated-trading-system.com/",
        "author_email": "jez@automated-trading-system.com",
        "author_ip": "79.72.225.146",
        "type": ""
    },
    {
        "date_created_gmt": "2010-03-10T13:46:02.000Z",
        "user_id": "3046554",
        "comment_id": "40",
        "parent": "39",
        "status": "approve",
        "content": "Hi Leon,\n\nI don't, but it should be fairly easy to modify and for updates.\n\n-JP",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-40",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "JP",
        "author_url": "http://techneur.com",
        "author_email": "jp@reflect7.com",
        "author_ip": "76.84.63.225",
        "type": ""
    },
    {
        "date_created_gmt": "2010-03-06T17:34:09.000Z",
        "user_id": "0",
        "comment_id": "39",
        "parent": "0",
        "status": "approve",
        "content": "Hi JP,\r\n\r\nGreat job. This is exactly what I need. Now my inserts got wings. 200000 inserts under 3 seconds, amazing. I was wondering. Do You also have such magic code for doing updates?\r\n\r\nThanQ...",
        "link": "https://procbits.wordpress.com/2009/09/08/sqlite-bulk-insert/#comment-39",
        "post_id": "30",
        "post_title": "SQLite Bulk Insert In&nbsp;C#/.NET",
        "author": "Leon",
        "author_url": "",
        "author_email": "lbost@inscore.nl",
        "author_ip": "84.25.142.245",
        "type": ""
    }
]